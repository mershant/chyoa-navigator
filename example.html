<div id="chyoa-navigator-drawer" class="chyoa-navigator-settings">
    <div class="inline-drawer">
        <div class="inline-drawer-toggle inline-drawer-header">
            <b>Chyoa Navigator</b>
            <div class="inline-drawer-icon fa-solid fa-circle-chevron-down down"></div>
        </div>
        <div class="inline-drawer-content">
            <!-- Enable/Disable Toggle -->
            <div
                style="margin-bottom: 15px; padding: 10px; background: #1a1a1a; border: 1px solid #444; border-radius: 5px;">
                <label class="checkbox_label" style="font-size: 1.1em; font-weight: bold;">
                    <input id="enable_toggle" type="checkbox" />
                    Enable for this chat
                </label>
                <small style="display: block; margin-top: 5px; color: #aaa;">Defaults to OFF for each new chat</small>
            </div>

            <!-- Source Text Area -->
            <div style="margin-bottom: 10px;">
                <label for="source_text">Source Text (Full Chapter)</label>
                <textarea id="source_text" class="text_pole" rows="10"
                    placeholder="Paste the full story/chapter here..."></textarea>
                <small>Highlight the part you want to simulate.</small>
            </div>

            <!-- Selection Preview -->
            <div style="margin-bottom: 10px; padding: 5px; border: 1px solid #444; background: #222;">
                <label>Selected for Simulation:</label>
                <div id="selection_preview"
                    style="font-style: italic; color: #aaa; max-height: 100px; overflow-y: auto; white-space: pre-wrap;">
                    (No text selected)</div>
            </div>

            <!-- OOC Settings -->
            <div style="margin-bottom: 10px;">
                <label for="ooc_pre">Pre-Prompt (OOC1)</label>
                <textarea id="ooc_pre" class="text_pole" rows="3"
                    placeholder="[OOC1: Below is the scenario...]"></textarea>
            </div>

            <div style="margin-bottom: 10px;">
                <label for="ooc_post">Post-Prompt (OOC2)</label>
                <textarea id="ooc_post" class="text_pole" rows="3" placeholder="[OOC2: Your job is to...]"></textarea>
            </div>

            <!-- Toggles -->
            <div style="margin-bottom: 10px;">
                <label class="checkbox_label">
                    <input id="separate_protagonist" type="checkbox" />
                    The protagonist is separate from {{user}}
                </label>
            </div>

            <div style="margin-bottom: 10px;">
                <label class="checkbox_label">
                    <input id="preserve_dialogue" type="checkbox" />
                    Preserve original dialogue verbatim
                </label>
            </div>

            <!-- Injection Depth -->
            <div style="margin-bottom: 10px; border-top: 1px solid #444; padding-top: 10px;">
                <label for="injection_depth">Injection Depth (messages from end)</label>
                <input id="injection_depth" type="number" class="text_pole" min="0" value="4" />
                <small>0 = at the very end, 1 = before last message, etc.</small>
            </div>

            <!-- Test Button -->
            <div style="margin-bottom: 10px;">
                <button id="test_injection_btn" class="menu_button">Test Injection (Check Console)</button>
            </div>

            <p><small>Selection is auto-saved per-chat.</small></p>
        </div>
    </div>
</div>